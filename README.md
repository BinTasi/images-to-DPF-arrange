# 批量图片转A4 PDF工具

一个功能强大的Python脚本工具，用于将文件夹中的图片自动转换为A4大小的PDF文件，支持2×3网格布局，并在每张图片下方显示原文件名。

## 功能特点

### 核心功能
- **批量处理**：自动扫描指定文件夹中的所有图片文件
- **A4格式**：生成标准A4尺寸(210mm × 297mm)的PDF文件
- **网格布局**：每张A4页面包含2列3行共6张图片
- **自动分页**：根据图片数量自动计算并生成多页PDF
- **文件名显示**：在每张图片下方自动添加原文件名

### 额外特性
- **智能缩放**：自动按比例缩放图片以适应页面布局
- **居中对齐**：图片在各自网格单元中水平和垂直居中
- **日志记录**：详细记录转换过程和结果
- **命令行支持**：支持通过命令行参数自定义输入输出路径
- **错误处理**：对损坏或不支持的图片文件进行优雅处理

## 支持的图片格式

工具支持所有Python PIL库支持的图片格式，包括但不限于：
- JPEG (.jpg, .jpeg)
- PNG (.png)
- BMP (.bmp)
- TIFF (.tiff, .tif)
- GIF (.gif)

## 安装和运行

### 方法一：直接运行可执行文件（推荐）

~~1. 下载并解压缩工具包~~
~~2. 双击运行 `运行图片转PDF工具.bat` 文件~~
~~3. 工具将自动处理当前目录中的所有图片~~
- 直接运行 `images-to-DPF-arrange-1.1.exe` 文件即可

### 方法二：使用Python脚本

#### 环境要求
- Python 3.6+ 安装
- Pillow 和 reportlab 依赖库

#### 安装依赖
```bash
pip install Pillow reportlab
```

#### 运行脚本
```bash
# 默认处理当前目录
python batch_images_to_a4_pdf_with_logging.py

# 指定输入目录
python batch_images_to_a4_pdf_with_logging.py --input 图片文件夹路径

# 同时指定输入和输出目录
python batch_images_to_a4_pdf_with_logging.py --input 图片文件夹路径 --output PDF输出路径
```

## 命令行参数

| 参数 | 缩写 | 描述 |
|------|------|------|
| `--input` | `-i` | 指定要处理的图片文件夹路径（默认为当前目录） |
| `--output` | `-o` | 指定PDF输出文件夹路径（默认为在输入目录下创建 `pdf_output` 子文件夹） |

## 输出结果

- 生成的PDF文件默认保存在输入目录下的 `pdf_output` 子文件夹中
- PDF文件命名格式：`images_to_pdf_YYYYMMDD_HHMMSS.pdf`（包含时间戳）
- 每个PDF文件包含多张A4页面，每页2×3布局显示6张图片
- 每张图片下方显示原文件名

## 工具结构

```
├── batch_images_to_a4_pdf_with_logging.py  # 主程序脚本
├── 运行图片转PDF工具.bat                     # Windows批处理文件
├── README.md                                # 工具说明文档
├── dist/                                    # 可执行文件目录
│   └── batch_images_to_a4_pdf_with_logging.exe
└── logs/                                    # 日志文件目录
    └── image_to_pdf_YYYYMMDD_HHMMSS.log
```

## 技术说明

### 布局计算
- 页面边距：上下左右各30mm
- 有效打印区域：约150mm × 237mm
- 图片大小：约65mm × 75mm
- 网格布局：2列3行

### 图片处理流程
1. 扫描指定文件夹中的所有图片文件
2. 按文件名排序图片
3. 计算所需页数（每6张图片一页）
4. 创建PDF文档和A4页面
5. 逐页绘制图片和文件名
6. 保存PDF文件

## 注意事项

1. **图片质量**：工具会按比例缩放图片以适应布局，但不会降低图片质量
2. **文件名长度**：如果文件名过长，可能会被自动截断显示
3. **文件类型**：仅处理图片文件，忽略其他类型文件
4. **权限问题**：确保对输入输出目录有读写权限
5. **运行环境**：Windows系统推荐使用批处理文件运行

## 更新日志

### v1.0.0
- 初始版本发布
- 支持批量图片转A4 PDF
- 2×3网格布局
- 图片自动缩放和居中

### v1.1.0
- 新增文件名显示功能
- 优化日志记录
- 修复窗口模式下的退出问题
- 支持命令行参数
